<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	layout:decorate="~{layouts/messageLayout}">

<th:block layout:fragment="css">
	<style>
.messages-box, .chat-box {
	height: 400px;
	overflow-y: scroll;
}

.text-small {
	font-size: 0.9rem;
}

.rounded-lg {
	border-radius: 0.5rem;
}

input::placeholder {
	font-size: 0.9rem;
	color: #999;
}
</style>

</th:block>

<th:block layout:fragment="script">
	<script th:src="@{/js/message/msgList.js}"></script>
	<script src="https://code.iconify.design/2/2.2.1/iconify.min.js"></script>
</th:block>

<div layout:fragment="content">
	<div class="container-fluid h-100">
		<div class="row h-100">
			<div class="col-12 h-100">
				<h2 class="text-center m-0 pt-5" style="height: 15%;"
					th:text="${fromId} + '님의 쪽지함'"></h2>
				<div class="d-flex justify-content-center" style="height: 8%;">
					<div class="d-flex align-items-center">
						<!--/* 검색 영역 */-->
						<div class="input-group" id="adv-search" th:align="center">
							<select id="searchType" class="form-control"
								style="width: 100px;">
								<option value="">전체</option>
								<option value="id">받는사람 아이디</option>
								<option value="tonum">받는사람 회원번호</option>
								<option value="content">내용</option>
							</select> <input type="text" id="searchKeyword" class="form-control"
								placeholder="키워드를 입력해 주세요." style="width: 300px;" />
							<button type="button">검색</button>
						</div>

					</div>
				</div>
				<div class="text-left pl-5">
					<button type="button" class="btn btn-primary" data-toggle="modal"
						data-target="#exampleModal" data-whatever="messageToId">쪽지
						보내기</button>
				</div>
				<div class="row justify-content-center" style="height: 68%;">
					<div class="col-5 pr-0">
						<div class="messages-box" style="height: 95%;">
							 <th:block th:each="m : ${mldtos}" th:if="${mldtos != null}">
								<a
									th:href="@{'/messagebox/' + ${m.messageFromNum} + '/' + ${m.messageToNum}}"
									class="list-group-item list-group-item-action rounded-0">
									<div class="media">
										<img th:href="@{'/member/' + ${m.messageToNum}}"
											src="https://bootstrapious.com/i/snippets/sn-chat/avatar.svg"
											alt="user" width="50" class="rounded-circle">
										<div class="media-body ml-4">
											<div
												class="d-flex align-items-center justify-content-between mb-1">
												<h6 class="mb-0" th:text="${m.messageToId}"></h6>
												<small class="small font-weight-bold">여기에 날짜를 넣으면
													됩니당</small>
											</div>
											<p class="font-italic mb-0 text-small"
												th:text="${m.recentContent}"></p>
										</div>
									</div>
									<div class="text-right">
										<button class="btn btn-danger btn-sm"
											th:onclick="deleteMessage([[${m.messageFromNum}]], [[${m.messageToNum}]])"
											type="button">쪽지함 삭제</button>
									</div>
								</a>
							</th:block>
						</div>
					</div>
					<div class="col-6">
						<div class="card chat-box">
						<div class="card-body">
							<!-- Sender Message-->
							<div class="media w-50 mb-3">
								<img
									src="https://bootstrapious.com/i/snippets/sn-chat/avatar.svg"
									alt="user" width="50" class="rounded-circle">
								<div class="media-body ml-3">
									<div class="bg-light rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-muted">Test which is a new
											approach all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>

							<!-- Reciever Message-->
							<div class="media w-50 ml-auto mb-3">
								<div class="media-body">
									<div class="bg-primary rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-white">Test which is a new
											approach to have all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>
							<!-- Sender Message-->
							<div class="media w-50 mb-3">
								<img
									src="https://bootstrapious.com/i/snippets/sn-chat/avatar.svg"
									alt="user" width="50" class="rounded-circle">
								<div class="media-body ml-3">
									<div class="bg-light rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-muted">Test which is a new
											approach all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>

							<!-- Reciever Message-->
							<div class="media w-50 ml-auto mb-3">
								<div class="media-body">
									<div class="bg-primary rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-white">Test which is a new
											approach to have all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>
							<!-- Sender Message-->
							<div class="media w-50 mb-3">
								<img
									src="https://bootstrapious.com/i/snippets/sn-chat/avatar.svg"
									alt="user" width="50" class="rounded-circle">
								<div class="media-body ml-3">
									<div class="bg-light rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-muted">Test which is a new
											approach all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>

							<!-- Reciever Message-->
							<div class="media w-50 ml-auto mb-3">
								<div class="media-body">
									<div class="bg-primary rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-white">Test which is a new
											approach to have all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>
							<!-- Sender Message-->
							<div class="media w-50 mb-3">
								<img
									src="https://bootstrapious.com/i/snippets/sn-chat/avatar.svg"
									alt="user" width="50" class="rounded-circle">
								<div class="media-body ml-3">
									<div class="bg-light rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-muted">Test which is a new
											approach all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>

							<!-- Reciever Message-->
							<div class="media w-50 ml-auto mb-3">
								<div class="media-body">
									<div class="bg-primary rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-white">Test which is a new
											approach to have all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>
							<!-- Sender Message-->
							<div class="media w-50 mb-3">
								<img
									src="https://bootstrapious.com/i/snippets/sn-chat/avatar.svg"
									alt="user" width="50" class="rounded-circle">
								<div class="media-body ml-3">
									<div class="bg-light rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-muted">Test which is a new
											approach all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>

							<!-- Reciever Message-->
							<div class="media w-50 ml-auto mb-3">
								<div class="media-body">
									<div class="bg-primary rounded py-2 px-3 mb-2">
										<p class="text-small mb-0 text-white">Test which is a new
											approach to have all solutions</p>
									</div>
									<p class="small text-muted">12:00 PM | Aug 13</p>
								</div>
							</div>
						</div>
							<div class="card-footer">
								<!-- Typing area -->
								<form action="#" class="">
									<div class="input-group">
										<div class="input-group-append">
											<span class="input-group-text iconify w-100 h-100 	"
												data-icon="fluent:attach-20-filled"></span>
										</div>
										<input type="text" placeholder="내용을 입력하세요"
											aria-describedby="button-addon2"
											class="form-control rounded-0 border-2 bg-light">
										<div class="input-group-append">
											<button id="button-addon2" type="submit"
												class="btn btn-secondary">전송</button>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
	</div>
	<!-- 쪽지 보내기 모달창 -->
	<div>
		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
			aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">쪽지 보내기✉️</h5>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<form name="msgForm" id="msgForm" th:object="${mdto}"
						th:method="post">
						<div class="modal-body">
							<div class="form-group">
								<label for="recipient-name" class="col-form-label">받는 사람</label>
								<input type="text" class="form-control"
									th:field="*{messageToId}" placeholder="아이디나 이름을 입력하세요!">
							</div>
							<div class="form-group">
								<label for="message-text" class="col-form-label">쪽지 내용</label>
								<textarea class="form-control" th:field="*{content}"
									id="content"></textarea>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary"
								data-dismiss="modal">취소</button>
							<button type="submit" class="btn btn-primary">쪽지 보내기</button>
							<input type="hidden" th:name="${_csrf.parameterName}"
								th:value="${_csrf.token}">
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
</html>
