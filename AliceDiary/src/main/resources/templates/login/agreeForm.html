<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<form action="/AliceDiary/register">
	<div>
		<fieldset>
			<legend>이용약관</legend>
			<p>
				<textarea id="text1" readonly>
				이용약관
			</textarea>
				<br /> <label for="agreement1">동의</label> <input id="agreement1"
					type="checkbox" name="chk" />
			</p>
		</fieldset>
	</div>
	<div>
		<fieldset>
			<legend>개인정보 취급방침</legend>
			<p>
				<textarea id="text2" readonly>
				개인정보 방침 및 안내
			</textarea>
				<br /> <label for="agreement2">동의</label> <input id="agreement2"
					type="checkbox" name="chk" />
			</p>
		</fieldset>
	</div>
	<div>
		<input type="checkbox" id="selectAll" />모두 동의
	</div>

	<div style="text-align: center">
		<button type="button" th:onclick="return next()">다음</button>
		<button type="button" th:onclick="regCancle()">가입 취소</button>
	</div>

</form>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<link id="contextPathHolder"
	th:data-contextPath="${#httpServletRequest.getContextPath()}" />

<!-- 체크박스 체크여부 -->
<script type="text/javascript">
	$("input:checkbox").click(checkedChange);
	function checkedChange() {
		if ($(this).prop("checked")) {
			$("label[for=" + this.id + "]").text("동의되었습니다.");
			$("label[for=" + this.id + "]").css("color", "blue");
		} else {
			$("label[for=" + this.id + "]").text("동의");
			$("label[for=" + this.id + "]").css("color", "black");
		}
	}

	$(document).ready(function() {
		$("#selectAll").click(function() {
			if ($("#selectAll").is(":checked"))
				$("input[name=chk]").prop("checked", true);
			else
				$("input[name=chk]").prop("checked", false);
		});

		$("input[name=chk]").click(function() {
			var total = $("input[name=chk]").length;
			var checked = $("input[name=chk]:checked").length;

			if (total != checked)
				$("#selectAll").prop("checked", false);
			else
				$("#selectAll").prop("checked", true);
		});
	});

	function next() {
		if (!$("#selectAll").is(":checked")) {
			alert("약관에 동의해주세요.");
			return false;
		} else {
			document.location.href = "./register";
		}
	}

	function regCancle() {
		if (!confirm("가입을 취소하시겠습니까?")) {
			return;
		} else {
			alert("가입이 취소되었습니다.");
			var contextPath = $('#contextPathHolder').attr('data-contextPath') ? $(
					'#contextPathHolder').attr('data-contextPath')
					: '';
			location = contextPath + "/";
		}
	}
</script>